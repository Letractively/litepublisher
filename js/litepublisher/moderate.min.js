var commentclient;function createcommentclient(){return new rpc.ServiceProxy(ltoptions.url+"/rpc.xml",{asynchronous:!0,protocol:"XML-RPC",sanitize:!1,methods:"litepublisher.moderate,litepublisher.deletecomment,litepublisher.comments.setstatus,litepublisher.comments.add,litepublisher.comments.get,litepublisher.comments.edit,litepublisher.comments.reply,litepublisher.comments.getrecent".split(",")})}
function movecomment(a,b){var c=document.getElementById("comment-"+a),d=ltoptions.commentsid;"hold"==b&&(d="hold"+ltoptions.commentsid);document.getElementById(d).appendChild(c.cloneNode(!0));c.parentNode.removeChild(c)}
function deletecomment(a){confirm(lang.comments.confirmdelete)&&(void 0==commentclient&&(commentclient=createcommentclient()),commentclient.litepublisher.deletecomment({params:["","",a,ltoptions.idpost],onSuccess:function(){var b=document.getElementById("comment-"+a);b.parentNode.removeChild(b)},onException:function(){alert(lang.comments.notdeleted)},onComplete:function(){}}))}
function setcommentstatus(a,b){void 0==commentclient&&(commentclient=createcommentclient());commentclient.litepublisher.comments.setstatus({params:["","",a,ltoptions.idpost,b],onSuccess:function(){movecomment(a,b)},onException:function(){alert(lang.comments.notmoderated)},onComplete:function(){}})}
function moderate(a,b){if("delete"!=b||confirm(lang.comments.confirmdelete))void 0==commentclient&&(commentclient=createcommentclient()),commentclient.litepublisher.moderate({params:["","",ltoptions.idpost,a,b],onSuccess:function(){for(var c=0,d=a.length;c<d;c++)if("delete"==b){var e=document.getElementById("comment-"+a[c]);e.parentNode.removeChild(e)}else movecomment(a[c],b)},onException:function(){alert(lang.comments.notmoderated)},onComplete:function(){}})}
function submitmoderateform(a,b){for(var c=[],d=0,e=a.elements.length;d<e;d++){var f=a.elements[d];"checkbox"==f.type&&!0==f.checked&&c.push(parseInt(f.value))}moderate(c,b)}
function editcomment(a){void 0==commentclient&&(commentclient=createcommentclient());commentclient.litepublisher.comments.get({params:["","",a,ltoptions.idpost],onSuccess:function(b){try{document.getElementById("name").value=b.name,document.getElementById("email").value=b.email,document.getElementById("url").value=b.url,document.getElementById("comment").value=b.rawcontent,document.getElementById("commentform").onsubmit=submiteditcomment(a),document.getElementById("name").focus()}catch(c){alert(c.message)}},
onException:function(){alert(lang.comments.errorrecieved)},onComplete:function(){}})}
function submiteditcomment(a){return function(){commentclient.litepublisher.comments.edit({params:["","",a,ltoptions.idpost,{name:document.getElementById("name").value,email:document.getElementById("email").value,url:document.getElementById("url").value,content:document.getElementById("comment").value}],onSuccess:function(){document.getElementById("name").value="";document.getElementById("email").value="";document.getElementById("url").value="";var b=document.getElementById("comment").value;document.getElementById("comment").value=
"";document.getElementById("commentform").onsubmit=null;document.getElementById("commentcontent-"+a).innerHTML=b;document.getElementById("checkbox-comment-"+a).focus()},onException:function(){alert(lang.comments.notedited)},onComplete:function(){}});return!1}}
function sendreply(){try{var a=document.getElementById("comment").value;""==a?alert(lang.comment.emptycontent):(void 0==commentclient&&(commentclient=createcommentclient()),commentclient.litepublisher.comments.reply({params:["","",0,ltoptions.idpost,a],onSuccess:function(){try{document.getElementById("comment").value="",window.location.reload(!0)}catch(a){alert(a.message)}},onException:function(){alert(lang.comments.notedited)},onComplete:function(){}}))}catch(b){alert(b.message)}};
