function initdatepicker(a){var b=$("#date").val();$(a).datepicker({altField:"#date",altFormat:"dd.mm.yy",dateFormat:"dd.mm.yy",changeYear:!0});$("#datepicker").datepicker("setDate",b)}function loadcontenttabs(){$("#loadcontenttabs").remove();$.get(ltoptions.url+"/admin/ajaxposteditor.htm",{id:ltoptions.idpost,get:"contenttabs"},function(a){$(a).insertBefore("#raweditor");$("#raweditor").appendTo("#rawtab");$("#contenttabs").tabs({cache:!0})})}
function str_replace(a,b,c){if(!(b instanceof Array)&&(b=Array(b),a instanceof Array))for(;a.length>b.length;)b[b.length]=b[0];for(a instanceof Array||(a=Array(a));a.length>b.length;)b[b.length]="";if(c instanceof Array){for(d in c)c[d]=str_replace(a,b,c[d]);return c}for(var d=0;d<a.length;d++)for(var e=c.indexOf(a[d]);-1<e;)c=c.replace(a[d],b[d]),e=c.indexOf(a[d],e);return c}
function addtocurrentfiles(){$("input:checked[id^='itemfilepage']").each(function(){$(this).attr("checked",!1);var a=$(this).val();0==$("#currentfile-"+a).length&&(a=str_replace(["pagefile-","pagepost-","itemfilepage-"],["curfile-","curpost-","currentfile-"],$("<div></div>").append($(this).parent().clone()).html()),$("#currentfilestab > :first").append(a))})}function getpostfiles(){var a=[];$("input[id^='currentfile']").each(function(){a.push($(this).val())});return a.join(",")}
function initfiletabs(){var a=$.when($.load_script(ltoptions.files+"/js/swfupload/swfupload.js"),$.load_script(ltoptions.files+"/js/litepublisher/swfuploader.min.js"));$.get(ltoptions.url+"/admin/ajaxposteditor.htm",{id:ltoptions.idpost,get:"files"},function(b){$("#filebrowser").html(b);$("#filetabs").tabs({cache:!0});$(document).on("click","input[id^='addfilesbutton']",addtocurrentfiles);$("#deletecurrentfiles").click(function(){$("input:checked[id^='currentfile']").each(function(){$(this).parent().remove()});
return!1});$("form:first").submit(function(){$("input[name='files']").val(getpostfiles())});a.done(function(){ltoptions.swfu=createswfu()})})}function tagtopost(){var a=$(this).text(),b=$("#text-tags").val();if(""==b)$("#text-tags").val(a);else{for(var c=b.split(/\s*,\s*/),d=c.length;0<=d;d--)if(a==c[d])return!1;$("#text-tags").val(b+", "+a)}return!1}function error_dialog(){$("#dialog_error").dialog({autoOpen:!0,modal:!0,buttons:[{text:"Ok",click:function(){$(this).dialog("close")}}]})}
function initposteditor(){$("#tabs").tabs({cache:!0,load:function(a,b){var c=$("#datepicker, datepicker",b.panel);c.length?$.load_script(ltoptions.files+"/js/jquery/ui-"+$.ui.version+"/jquery.ui.datepicker.min.js",function(){"en"==ltoptions.lang?initdatepicker(c):$.load_script(ltoptions.files+"/js/jquery/ui-"+$.ui.version+"/jquery.ui.datepicker-"+ltoptions.lang+".js",function(){initdatepicker(c)})}):$("a[rel='tagtopost']",b.panel).click(tagtopost)}});$("a[rel~='initfiletabs']").one("click",function(){initfiletabs();
return!1});$("a[rel~='loadcontenttabs']").one("click",function(){loadcontenttabs();return!1});$("form:first").submit(function(){if(""==$("input[name='title']").val())return error_dialog("empty title"),!1})};
