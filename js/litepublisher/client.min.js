var client;var widgets={items:[]};function createclient(){return new rpc.ServiceProxy(ltoptions.pingback,{asynchronous:true,protocol:"XML-RPC",sanitize:false,methods:["litepublisher.getwidget","litepublisher.moderate","litepublisher.deletecomment","litepublisher.comments.setstatus","litepublisher.comments.add","litepublisher.comments.get","litepublisher.comments.edit","litepublisher.comments.reply","litepublisher.comments.getrecent","litepublisher.files.getbrowser","litepublisher.files.getpage","litepublisher.files.geticons","litepublisher.files.getthemes","litepublisher.files.gettags"]})}widgets.load=function(c,e,b){var d=findcomment(c,e);if(!d){return alert("Widget not found")}var a=widgets.add(c,d);if(client==undefined){client=createclient()}client.litepublisher.getwidget({params:[e,b,ltoptions.idurl],onSuccess:function(f){if(f&&(f!="false")){var g=document.createElement("div");g.innerHTML=f;if(g.firstChild.nodeName==String.fromCharCode(35)+"text"){var h=g}else{var h=g.firstChild}h.parentNode.removeChild(h);d.parentNode.replaceChild(h,d);widgets.items[a][1]=h}else{c.onclick=null}},onException:function(f){},onComplete:function(f){}})};widgets.inlineload=function(c){var d=findcomment(c,false);if(!d){return alert("Widget not found")}var a=document.createElement("div");a.innerHTML=d.nodeValue;if(a.firstChild.nodeName==String.fromCharCode(35)+"text"){var b=a}else{var b=a.firstChild}b.parentNode.removeChild(b);d.parentNode.replaceChild(b,d);return widgets.add(c,b)};widgets.add=function(a,b){a.onclick=widgets.hide;widgets.items.push([a,b]);return widgets.items.length-1};widgets.setitem=function(b,c){for(var a=widgets.items.length-1;a>=0;a--){if(b==widgets.items[a][0]){widgets.items[a][1]=c;return}}widgets.add(b,c)};widgets.setvisible=function(b,d){try{for(var a=widgets.items.length-1;a>=0;a--){if(b==widgets.items[a][0]){var c=widgets.items[a][1];break}}if(d){c.style.visibility="visible";c.style.display="block";b.onclick=widgets.hide}else{c.style.visibility="hidden";c.style.display="none";b.onclick=widgets.show}}catch(f){alert(f.message)}};widgets.hide=function(){widgets.setvisible(this,false)};widgets.show=function(){widgets.setvisible(this,true)};function findnextnode(b,a,c){while(b=b.nextSibling){if(b.nodeName==a){if(c==false){return b}if(b.nodeValue==c){return b}}}return false}function findcomment(b,d){var a=String.fromCharCode(35)+"comment";if(d){var c="widgetcontent-"+d}else{var c=false}if(result=findnextnode(b,a,c)){return result}if(result=findnextnode(b.parentNode,a,c)){return result}if(result=findnextnode(b.parentNode.parentNode,a,c)){return result}return false}function loadjavascript(b){if(ltoptions.scripts==undefined){ltoptions.scripts=""}if(ltoptions.scripts.indexOf(b)>=0){return false}if(b.substring(0,7)!="http://"){b=ltoptions.files+b}ltoptions.scripts+=b+"\n";var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src=b;var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(a,c);return true}function audioplayerloaded(){AudioPlayer.setup(ltoptions.files+"/js/audio-player/player.swf",{width:290});if(ltoptions.audiofile!=undefined){playaudiofile(ltoptions.audiofile[0],ltoptions.audiofile[1])}else{ltoptions.audiofile=true}}function playaudiofile(b,a){if(ltoptions.audiofile==undefined){ltoptions.audiofile=new Array(b,a);loadjavascript("/js/audio-player/audio-player.js")}else{AudioPlayer.embed(b,{soundFile:a,autostart:"yes",initialvolume:100})}}function videoplayerloaded(){if(ltoptions.videofile!=undefined){playvideofile(ltoptions.videofile[0],ltoptions.videofile[1])}else{ltoptions.videofile=true}}function playvideofile(b,a){if(ltoptions.videofile==undefined){ltoptions.videofile=new Array(b,a);loadjavascript("/js/flowplayer/flowplayer-3.1.4.min.js")}else{flowplayer(b,ltoptions.files+"/js/flowplayer/flowplayer-3.1.5.swf",{clip:{autoPlay:true,autoBuffering:true,bufferLength:5}})}}function htmlentities(a){var c=document.createElement("div");var b=document.createTextNode(a);c.appendChild(b);return c.innerHTML};