(function(a,f){litepubl.Posteditor=Class.extend({init:function(){var b=a("#tabs");if(0!=b.length){var c=this;b.tabs({cache:!0,select:function(b,d){a("#datetime-holder",d.panel).length?c.init_datetime_tab(d.panel):a("#seo-holder",d.panel).length&&c.init_seo_tab(d.panel)},load:function(b,d){a(".posteditor-tag",d.panel).click(function(){c.addtag(a(this).text());return!1})}});a("#posteditor-init-raw-tabs").one("click",function(){c.init_raw_tabs();return!1});a("#posteditor-init-files").one("click.initfiles",
function(){litepubl.fileman=new litepubl.Fileman("#posteditor-files");return!1});a("form:first").submit(function(){if(""==a.trim(a("input[name='title']").val()))return a.messagebox(lang.dialog.error,lang.posteditor.emptytitle),!1})}},addtag:function(b){var c=a("#text-tags").val();if(""==c)a("#text-tags").val(b);else{for(var e=c.split(/\s*,\s*/),d=e.length;0<=d;d--)if(b==e[d])return!1;a("#text-tags").val(c+", "+b)}},init_seo_tab:function(b){b=a("#seo-holder",b);b.replaceWith(b.get(0).firstChild.nodeValue)},
init_datetime_tab:function(b){b=a("#datetime-holder",b);b.replaceWith(b.get(0).firstChild.nodeValue);this.load_ui_datepicker(function(){var b=a("#text-date").val();a("#datepicker").datepicker({altField:"#text-date",altFormat:"dd.mm.yy",dateFormat:"dd.mm.yy",changeYear:!0});a("#datepicker").datepicker("setDate",b)})},load_ui_datepicker:function(b){a.load_script(ltoptions.files+"/js/jquery/ui-"+a.ui.version+"/jquery.ui.datepicker.min.js",function(){if("en"==ltoptions.lang)return b();a.load_script(ltoptions.files+
"/js/jquery/ui-"+a.ui.version+"/jquery.ui.datepicker-"+ltoptions.lang+".js",b)})},init_raw_tabs:function(){a("#posteditor-init-raw-tabs").remove();var b=a("#posteditor-raw-holder"),c=b.get(0).firstChild.nodeValue;a(b.get(0).firstChild).remove();var c=c.replace(/<comment>/gim,'<div class="tab-holder"><\!--').replace(/<\/comment>/gim,"--\></div>"),e=c.indexOf("<div");a("#posteditor-raw").before(c.substring(0,e)).after(c.substring(e));b.tabs({cache:!0,select:function(b,c){var e=a(".tab-holder",c.panel);
e.length&&e.replaceWith(e.get(0).firstChild.nodeValue)}})},init_visual_link:function(b,c){a('<a href="#">'+c+"</a>").appendTo("#posteditor-visual").data("url",b).one("click",function(){a.load_script(a(this).data("url"));a("#posteditor-visual").remove();return!1})}});a(f).ready(function(){try{litepubl.posteditor=new litepubl.Posteditor}catch(a){erralert(a)}})})(jQuery,document,window);
