(function(a){a.posteditor={init:function(){a("#tabs").tabs({cache:!0,select:function(b,c){a("#datetime-holder",c.panel).length?a.posteditor.init_datetime_tab(c.panel):a("#seo-holder",c.panel).length&&a.posteditor.init_seo_tab(c.panel)},load:function(b,c){a(".posteditor-tag",c.panel).click(function(){a.posteditor.addtag(a(this).text());return!1})}});a("#posteditor-init-raw-tabs").one("click",function(){a.posteditor.init_raw_tabs();return!1});a.fileman.init("#posteditor-files");a("#posteditor-init-files").one("click",
function(){a.fileman.init("#posteditor-files");return!1});a("form:first").submit(function(){if(""==a.trim(a("input[name='title']").val()))return a.messagebox(lang.dialog.error,lang.posteditor.emptytitle),!1})},addtag:function(b){var c=a("#text-tags").val();if(""==c)a("#text-tags").val(b);else{for(var d=c.split(/\s*,\s*/),e=d.length;0<=e;e--)if(b==d[e])return!1;a("#text-tags").val(c+", "+b)}},init_seo_tab:function(b){b=a("#seo-holder",b);b.replaceWith(b.get(0).firstChild.nodeValue)},init_datetime_tab:function(b){b=
a("#datetime-holder",b);b.replaceWith(b.get(0).firstChild.nodeValue);this.load_ui_datepicker(function(){var b=a("#text-date").val();a("#datepicker").datepicker({altField:"#text-date",altFormat:"dd.mm.yy",dateFormat:"dd.mm.yy",changeYear:!0});a("#datepicker").datepicker("setDate",b)})},load_ui_datepicker:function(b){a.load_script(ltoptions.files+"/js/jquery/ui-"+a.ui.version+"/jquery.ui.datepicker.min.js",function(){if("en"==ltoptions.lang)return b();a.load_script(ltoptions.files+"/js/jquery/ui-"+
a.ui.version+"/jquery.ui.datepicker-"+ltoptions.lang+".js",b)})},init_raw_tabs:function(){a("#posteditor-init-raw-tabs").remove();var b=a("#posteditor-raw-holder"),c=b.get(0).firstChild.nodeValue;a(b.get(0).firstChild).remove();var c=c.replace(/<comment>/gim,'<div class="tab-holder"><\!--').replace(/<\/comment>/gim,"--\></div>"),d=c.indexOf("<div");a("#posteditor-raw").before(c.substring(0,d)).after(c.substring(d));b.tabs({cache:!0,select:function(b,c){var d=a(".tab-holder",c.panel);d.length&&d.replaceWith(d.get(0).firstChild.nodeValue)}})},
init_visual_link:function(b,c){a('<a href="#">'+c+"</a>").appendTo("#posteditor-visual").data("url",b).one("click",function(){a.load_script(a(this).data("url"));a("#posteditor-visual").remove();return!1})}};a(document).ready(a.posteditor.init)})(jQuery);
