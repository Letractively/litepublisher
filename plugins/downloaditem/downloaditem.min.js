function get_get(a){var c=window.location.search.substring(1);var d=c.split("&");for(var b=0;b<d.length;b++){var e=d[b].split("=");if(a==e[0]){return decodeURIComponent(e[1])}}return false}function get_download_site(){var a="";if(a=get_get("site")){set_cookie("download_site",a)}else{a=get_cookie("download_site")}return a}function get_download_item(b,c){var a="itemtype="+c+"&url="+encodeURIComponent(b);var d=ltoptions.download_site.indexOf("?")==-1?"?":"&";return ltoptions.download_site+"/admin/service/upload/"+d+a}function siteurl_dialog(a){load_ui(function(){if($._url_dialog==undefined){$("#siteurl_dialog").dialog({autoOpen:false,modal:true,buttons:[{text:"Ok",click:function(){$(this).dialog("close");var b=$.trim($("#text_download_site").val());if(b!=""){set_cookie("download_site",b)}update_siteurl(b);if($.isFunction(a)){a()}}},{text:"Cancel",click:function(){$(this).dialog("close")}}]});$._url_dialog=true}$("#siteurl_dialog").dialog("open");$("#text_download_site").focus()})}function download_item_clicked(){var a=$(this).data("url");var b=$(this).attr("rel");if(ltoptions.download_site==""){siteurl_dialog(function(){window.location=get_download_item(a,b)})}return false}function update_siteurl(a){if("/"==a.charAt(a.length-1)){a=a.substring(0,a.length-1)}if(ltoptions.download_site==a){return}ltoptions.download_site=a;$("#text_download_site").val(a);var b=$("#yoursite");b.attr("href",a);b.attr("title",a);b.text(a);if(a==""){$("a[rel='theme'], a[rel='plugin']").click(download_item_clicked)}else{$("a[rel='theme'], a[rel='plugin']").each(function(){$(this).unbind("click");var d=$(this).attr("rel");var c=$(this).data("url");$(this).attr("href",get_download_item(c,d))})}}function init_download_items(){try{$("#change_url").click(function(){siteurl_dialog();return false});$("a[rel='theme'], a[rel='plugin']").each(function(){$(this).data("url",$(this).attr("href"))});if(url=get_download_site()){update_siteurl(url)}else{ltoptions.download_site="";$("a[rel='theme'], a[rel='plugin']").click(download_item_clicked)}}catch(a){alert("ex"+a.message)}}$(document).ready(init_download_items);