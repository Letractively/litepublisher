(function(d){var a={cookierequested:!1,cookie:"",voted:[]};d.pollclient=a;a.init=function(){$("*[id^='poll_']").click(function(){var b=$(this).attr("id").split("_");a.clickvote(b[1],b[2]);return!1});$("form[id^='pollform_radio_']").submit(function(){var b=$(this).attr("id").split("_"),c=$("input:radio:checked",$(this)).val();a.clickvote(b[2],c);return!1})};a.sendvote=function(b,c){$.get(ltoptions.url+"/ajaxpollserver.htm",{action:"sendvote",cookie:this.cookie,idpoll:b,vote:c},function(a){for(var a=
a.split(","),c="#pollresult_"+b+"_",e=0,d=a.length;e<d;e++)$(c+e).html(a[e])}).error(function(){a.error_dialog()})};a.clickvote=function(b,c){for(var d=this.voted.length-1;0<=d;d--)if(b==this.voted[d])return this.error_dialog(),!1;this.voted.push(b);this.cookierequested?this.sendvote(b,c):(this.cookie=get_cookie("polluser"),null==this.cookie&&(this.cookie=""),this.getcookie(function(){a.sendvote(b,c)}))};a.getcookie=function(b){$.get(ltoptions.url+"/ajaxpollserver.htm",{action:"getcookie",cookie:this.cookie},
function(c){c!=a.cookie&&(set_cookie("polluser",c,!1),a.cookie=c);a.cookierequested=!0;$.isFunction(b)&&b()})};a.error_dialog=function(){$.load_ui(function(){$(".poll_error_dialog:first").dialog({autoOpen:!0,modal:!0,buttons:[{text:"Ok",click:function(){$(this).dialog("close")}}]})})}})(window);
