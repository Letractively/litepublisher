function set_progress(a,b){switch(a){case -1:$(b).hide();break;case 0:$(b).show();$(b+" .uploadedpercent").text(a+" %");break;default:$(b+" .uploadedpercent").text(a+" %")}}function fileDialogComplete(){set_progress(0,this.customSettings.progress);var a=window.location.toString(),a=a+(-1==a.indexOf("?")?"?":"&");this.setUploadURL(a+"random="+Math.random());this.startUpload()}function uploadStart(){return!0}
function uploadProgress(a,b,d){set_progress(Math.ceil(100*(b/d)),this.customSettings.progress)}function uploadError(){set_progress(-1,this.customSettings.progress);alert("uploadError")}function uploadComplete(){set_progress(-1,this.customSettings.progress)}
function uploadSuccess(a,b){try{if("logourl"==this.customSettings.name){var d=$.parseJSON(b);$("#logo").css("padding-left",d.width);$("#text-color-logowidth").val(d.width);set_color("logourl",d.url)}else set_color(this.customSettings.name,b)}catch(e){alert("Error "+e.message)}}
function createswfu(a){a={flash_url:ltoptions.files+"/js/swfupload/swfupload.swf",upload_url:document.location,post_params:{formtype:a?"headerurl":"logourl"},file_size_limit:a?"4 MB":"10 MB",file_types:a?"*.jpg;*.png;*.gif":"*.png",file_types_description:"Images",file_upload_limit:100,file_queue_limit:1,button_image_url:ltoptions.files+"/js/swfupload/images/XPButtonNoText_160x22.png",button_text:'<span class="upload_button">'+(a?lang.themegenerator.upload_header:lang.themegenerator.upload_logo)+"</span>",
button_placeholder_id:a?"uploadbutton":"uploadlogo",button_width:160,button_height:22,button_text_style:".upload_button { font-family: Helvetica, Arial, sans-serif; font-size: 14pt; text-align: center; }",button_text_top_padding:1,button_text_left_padding:5,custom_settings:{name:a?"headerurl":"logourl",progress:a?"#progress_image":"#progress_logo"},file_dialog_complete_handler:fileDialogComplete,upload_start_handler:uploadStart,upload_progress_handler:uploadProgress,upload_error_handler:uploadError,
upload_success_handler:uploadSuccess,upload_complete_handler:uploadComplete};try{return new SWFUpload(a)}catch(b){alert("Error create swfupload "+b.message)}}
function set_color(a,b){if("themename"==a)$("#text-themename").val(b);else{var d=$("#text-color-"+a);if(0!=d.length){d.val(b);for(var d=0,e=ltoptions.colors.length;d<e;d++){var c=ltoptions.colors[d];if(a==c.name){var f=c.value.replace("%%"+a+"%%",b),g=f.split("%%");2<=g.length&&(g=g[1],f=f.replace("%%"+g+"%%",$("#text-color-"+g).val()));try{var h=c.sel;-1==h.indexOf(":")?$(h).css(c.propname,f):$("head:first").append('<style type="text/css">'+h+"{"+c.propname+":"+f+"}</style>")}catch(i){alert(c.sel+
"\n"+c.propname+" = "+f)}}}}}}function parse_ini(a){for(var a=a.split("\n"),b=0,d=a.length;b<d;b++){var e=$.trim(a[b]);if(!(""==e||"["==e.charAt(0))){var c=e.split("=");2==c.length&&(e=$.trim(c[0]),c=$.trim(c[1].replace('"',"").replace('"',"")),""!==e&&""!=c&&set_color(e,c))}}}
$(document).ready(function(){$("#menucolors, #ini_colors").click(function(){$("#"+$(this).attr("id")+"_toggle").slideToggle();return!1});ltoptions.swfu=createswfu(!0);ltoptions.swfulogo=createswfu(!1);$("input[id^='colorbutton']").ColorPicker({onSubmit:function(a,b,d,e){$(e).ColorPickerHide();try{set_color($(e).attr("rel"),b)}catch(c){alert(c.message)}},onBeforeShow:function(){var a="#text-color-"+$(this).attr("rel");$(this).ColorPickerSetColor($(a).val())}});$("#uploadcolor").submit(function(){parse_ini($("#inicolors").val());
$("#inicolors").val("");return!1})});
