/**
* Lite Publisher
* Copyright (C) 2010, 2011 Vladimir Yushko http://litepublisher.com/
* Dual licensed under the MIT (mit.txt)
* and GPL (gpl.txt) licenses.
**/

  $(document).ready(function() {
try {
    var images = $("a[rel^='prettyPhoto']");
if (images.length ) {
var dir = ltoptions.url + "/plugins/slideshow-nivo/";
$.load_css(dir + "nivo-slider.css");
$.load_css(dir + "themes/default/default.css");
var holder = $("#slider-nivo");
var width = holder.width();
var height = holder.height();
$(holder).wrap('<div class="slider-wrapper theme-default"></div>');
$('<div class="ribbon"></div>').insertBefore(holder);
//alert($("#slider-nivo").parent().html());
images.each(function() {
var url = $(this).attr("href");
var rel = $('img', this).attr("src");
$('<img src="' + url + '" alt="' + url + '" rel="' + rel + '" />').appendTo(holder);
});


//window.location = url + "jquery.nivo.slider.pack.js";
var img = new Image();
img.onload = function(){
$.load_script(dir + "jquery.nivo.slider.pack.js", function() {
try {
alert('loaded ' + holder.width());
    $(holder).nivoSlider({
controlNavThumbsFromRel: true
});

$.load_script(dir + "jquery.ez-bg-resize.js", function() {
alert(holder.width());
$("#slider-nivo").ezBgResize();
holder.width(width).height(width / 2);
alert(holder.width());
});
} catch(e) { alert(e.message); }
});
};

img.src = images.eq(0).attr("href");
}
} catch(e) { alert(e.message); }
});