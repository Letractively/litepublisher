(function(a){a(document).ready(function(){litepubl.uloginpopup=new litepubl.Uloginpopup});litepubl.Uloginpopup=Class.extend({script:!1,dialogopened:!1,html:'<div style="display:block;overflow:hidden;width:300px;height:200px;"><div id="ulogin-holder" data-ulogin="display=small;fields=email,first_name,last_name;optional=phone,nickname;providers=vkontakte,odnoklassniki,mailru,yandex,facebook,google,twitter;hidden=other;redirect_uri=%%redirurl%%;"></div>',init:function(){if(!a.cookie("litepubl_user")){this.html=
this.html.replace(/%%redirurl%%/gim,encodeURIComponent(ltoptions.url+"/admin/ulogin.htm?backurl="));var b=this;a('a[href^="'+ltoptions.url+'/admin/"], a[href^="/admin/"]').click(function(){b.open(a(this).attr("href"));return!1})}},open:function(b){if(this.dialogopened)return!1;set_cookie("backurl",b);var c=this;c.ready(function(){c.dialogopened=!0;a.prettyPhotoDialog({title:lang.ulogin.title,html:c.html.replace(/BACKURL=/gim,"BACKURL="+encodeURIComponent(b)),width:300,close:function(){c.dialogopened=
!1},open:function(){uLogin.customInit("ulogin-holder")},buttons:[{title:lang.dialog.close,click:a.proxy(a.prettyPhoto.close,a.prettyPhoto)}]})})},ready:function(b){return this.script?this.script.done(b):this.script=a.load_script("http://ulogin.ru/js/ulogin.js",b)}})})(jQuery,geo,window);
