function get_download_site(){var a="";(a=get_get("site"))?set_cookie("download_site",a):a=get_cookie("download_site");return a}function get_download_item(a,b){var c="itemtype="+b+"&url="+encodeURIComponent(a),d=-1==ltoptions.download_site.indexOf("?")?"?":"&";return ltoptions.download_site+"/admin/service/upload/"+d+c}
function siteurl_dialog(a){$.load_ui(function(){void 0==$._url_dialog&&($("#siteurl_dialog").dialog({autoOpen:!1,modal:!0,buttons:[{text:"Ok",click:function(){$(this).dialog("close");var b=$.trim($("#text_download_site").val());""!=b&&set_cookie("download_site",b);update_siteurl(b);$.isFunction(a)&&a()}},{text:"Cancel",click:function(){$(this).dialog("close")}}]}),$._url_dialog=!0);$("#siteurl_dialog").dialog("open");$("#text_download_site").focus()})}
function download_item_clicked(){var a=$(this).data("url"),b=$(this).attr("rel");""==ltoptions.download_site&&siteurl_dialog(function(){window.location=get_download_item(a,b)});return!1}
function update_siteurl(a){"/"==a.charAt(a.length-1)&&(a=a.substring(0,a.length-1));if(ltoptions.download_site!=a){ltoptions.download_site=a;$("#text_download_site").val(a);var b=$("#yoursite");b.attr("href",a);b.attr("title",a);b.text(a);""==a?$("a[rel='theme'], a[rel='plugin']").click(download_item_clicked):$("a[rel='theme'], a[rel='plugin']").each(function(){$(this).unbind("click");var a=$(this).attr("rel"),b=$(this).data("url");$(this).attr("href",get_download_item(b,a))})}}
function init_download_items(){try{$("#change_url").click(function(){siteurl_dialog();return!1}),$("a[rel='theme'], a[rel='plugin']").each(function(){$(this).data("url",$(this).attr("href"))}),(url=get_download_site())?update_siteurl(url):(ltoptions.download_site="",$("a[rel='theme'], a[rel='plugin']").click(download_item_clicked))}catch(a){alert("ex"+a.message)}}$(document).ready(init_download_items);
