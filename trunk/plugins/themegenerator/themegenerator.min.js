function set_progress(a,b){switch(a){case -1:$(b).hide();break;case 0:$(b).show();$(b+" .uploadedpercent").text(a+" %");break;default:$(b+" .uploadedpercent").text(a+" %")}}function fileDialogComplete(a,c){set_progress(0,this.customSettings.progress);var b=window.location.toString();b=b+(b.indexOf("?")==-1?"?":"&");this.setUploadURL(b+"random="+Math.random());this.startUpload()}function uploadStart(a){return true}function uploadProgress(a,c,b){set_progress(Math.ceil((c/b)*100),this.customSettings.progress)}function uploadError(a,c,b){set_progress(-1,this.customSettings.progress);alert("uploadError")}function uploadComplete(a){set_progress(-1,this.customSettings.progress)}function uploadSuccess(b,a){set_color(this.customSettings.name,a)}function createswfu(b){var a={flash_url:ltoptions.files+"/js/swfupload/swfupload.swf",upload_url:document.location,post_params:{formtype:b?"headerurl":"logourl"},file_size_limit:b?"4 MB":"1 MB",file_types:b?"*.jpg;*.png;*.gif":"*.png",file_types_description:"Images",file_upload_limit:100,file_queue_limit:1,button_image_url:ltoptions.files+"/js/swfupload/images/XPButtonNoText_160x22.png",button_text:'<span class="upload_button">'+(b?lang.themegenerator.upload_header:lang.themegenerator.upload_logo)+"</span>",button_placeholder_id:b?"uploadbutton":"uploadlogo",button_width:160,button_height:22,button_text_style:".upload_button { font-family: Helvetica, Arial, sans-serif; font-size: 14pt; text-align: center; }",button_text_top_padding:1,button_text_left_padding:5,custom_settings:{name:b?"headerurl":"logourl",progress:b?"#progress_image":"#progress_logo"},file_dialog_complete_handler:fileDialogComplete,upload_start_handler:uploadStart,upload_progress_handler:uploadProgress,upload_error_handler:uploadError,upload_success_handler:uploadSuccess,upload_complete_handler:uploadComplete};try{return new SWFUpload(a)}catch(c){alert("Error create swfupload "+c.message)}}function set_color(b,n){if(b=="themename"){$("#text-themename").val($value);return}var k=$("#text-color-"+b);if(k.length==0){return}k.val(n);for(var g=0,d=ltoptions.colors.length;g<d;g++){var o=ltoptions.colors[g];if(b==o.name){var f=o.value.replace("%%"+b+"%%",n);var m=f.split("%%");if(m.length>=2){var h=m[1];f=f.replace("%%"+h+"%%",$("#text-color-"+h).val())}try{var c=o.sel;if(c.indexOf(":")==-1){$(c).css(o.propname,f)}else{$("head:first").append('<style type="text/css">'+c+"{"+o.propname+":"+f+"}</style>")}}catch(j){alert(o.sel+"\n"+o.propname+" = "+f)}}}}function parse_ini(e){var d=e.split("\n");for(var g=0,c=d.length;g<c;g++){var h=$.trim(d[g]);if((h=="")||(h.charAt(0)=="[")){continue}var b=h.split("=");if(b.length!=2){continue}var f=$.trim(b[0]);var j=$.trim(b[1].replace('"',"").replace('"',""));if((f!=="")&&(j!="")){set_color(f,j)}}}$(document).ready(function(){$("#menucolors, #ini_colors").click(function(){$("#"+$(this).attr("id")+"_toggle").slideToggle();return false});ltoptions.swfu=createswfu(true);ltoptions.swfulogo=createswfu(false);$("input[id^='colorbutton']").ColorPicker({onSubmit:function(a,d,b,c){$(c).ColorPickerHide();try{set_color($(c).attr("rel"),d)}catch(f){alert(f.message)}},onBeforeShow:function(){var a="#text-color-"+$(this).attr("rel");$(this).ColorPickerSetColor($(a).val())}});$("#uploadcolor").submit(function(){parse_ini($("#inicolors").val());$("#inicolors").val("");return false})});