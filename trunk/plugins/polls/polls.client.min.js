(function(b,c){var a={cookierequested:false,cookie:"",voted:[]};b.pollclient=a;a.init=function(){$("*[id^='poll_']").click(function(){var d=$(this).attr("id").split("_");a.clickvote(d[1],d[2]);return false});$("form[id^='pollform_radio_']").submit(function(){var e=$(this).attr("id").split("_");var d=$("input:radio:checked",$(this)).val();a.clickvote(e[2],d);return false})};a.sendvote=function(d,e){$.get(ltoptions.url+"/ajaxpollserver.htm",{action:"sendvote",cookie:this.cookie,idpoll:d,vote:e},function(f){var g=f.split(",");var j="#pollresult_"+d+"_";for(var h=0,k=g.length;h<k;h++){$(j+h).html(g[h])}}).error(function(h,g,f){a.error_dialog()})};a.clickvote=function(d,e){for(var f=this.voted.length-1;f>=0;f--){if(d==this.voted[f]){this.error_dialog();return false}}this.voted.push(d);if(this.cookierequested){this.sendvote(d,e)}else{this.cookie=get_cookie("polluser");if(this.cookie==null){this.cookie=""}this.getcookie(function(){a.sendvote(d,e)})}};a.getcookie=function(d){$.get(ltoptions.url+"/ajaxpollserver.htm",{action:"getcookie",cookie:this.cookie},function(e){if(e!=a.cookie){set_cookie("polluser",e,false);a.cookie=e}a.cookierequested=true;if($.isFunction(d)){d()}})};a.error_dialog=function(){$.load_ui(function(){$(".poll_error_dialog:first").dialog({autoOpen:true,modal:true,buttons:[{text:"Ok",click:function(){$(this).dialog("close")}}]})})}})(window);