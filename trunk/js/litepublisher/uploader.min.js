(function(c){litepubl.Uploader=Class.extend({progressbar:"#progressbar",maxsize:"100",types:"*.*",onsettings:c.noop,onbefore:c.noop,onupload:c.noop,oncomplete:c.noop,before:function(a){var b=c("#combo-idperm_upload");b.length&&a.addPostParam("idperm",b.val());this.onbefore(a)},geturl:function(){return(void 0==ltoptions.uploadurl?ltoptions.url:ltoptions.uploadurl)+"/admin/jsonserver.php?random="+Math.random()},complete:function(){this.oncomplete(this.items);this.items.length=0},init:function(){this.items=
[];var a=void 0==ltoptions.uploadurl?ltoptions.url:ltoptions.uploadurl,b=get_cookie("litepubl_user");""==b&&(b=get_cookie("admin"));var d=this,a={flash_url:a+"/js/swfupload/swfupload.swf",upload_url:a+"/admin/jsonserver.php",post_params:{litepubl_user:b,litepubl_user_id:get_cookie("litepubl_user_id"),method:"files_upload"},file_size_limit:this.maxsize+" MB",file_types:this.types,file_types_description:"All Files",file_upload_limit:0,file_queue_limit:0,button_placeholder_id:"uploadbutton",file_dialog_complete_handler:function(){c(d.progressbar).progressbar({value:0});
this.setUploadURL(d.geturl());d.before(this);this.startUpload()},upload_start_handler:function(){return!0},upload_progress_handler:function(a,b,f){try{var g=Math.ceil(100*(b/f));c(d.progressbar).progressbar("value",g)}catch(e){this.debug(e)}},upload_error_handler:function(a,b,d){c.messagebox(lang.dialog.error,d)},upload_success_handler:function(a,b){try{var f=c.parseJSON(b);d.items.push(f);d.onupload(a,f)}catch(e){alert("error "+e.message)}},upload_complete_handler:function(){try{0===this.getStats().files_queued?
(c(d.progressbar).progressbar("destroy"),d.complete()):this.startUpload()}catch(a){this.debug(a)}}};"en"==ltoptions.lang?(a.button_image_url=ltoptions.files+"/js/swfupload/images/XPButtonUploadText_61x22.png",a.button_width=61,a.button_height=22):(a.button_text='<span class="upload_button">'+lang.posteditor.upload+"</span>",a.button_image_url=ltoptions.files+"/js/swfupload/images/XPButtonNoText_160x22.png",a.button_width=160,a.button_height=22,a.button_text_style=".upload_button { font-family: Helvetica, Arial, sans-serif; font-size: 14pt; text-align: center; }",
a.button_text_top_padding=1,a.button_text_left_padding=5);try{this.onsettings(a),this.uploader=new SWFUpload(a)}catch(e){alert("Error create swfupload "+e.message)}}})})(jQuery,window);
