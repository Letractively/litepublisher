(function(b,f,g){litepubl.Posteditor=Class.extend({tabs:!1,init:function(){this.tabs=b("#tabs");if(this.tabs.length){var a=this;this.tabs.tabs({hide:!0,show:!0,beforeLoad:litepubl.uibefore,beforeActivate:function(d,c){b("#datetime-holder",c.newPanel).length?a.init_datetime_tab(c.newPanel):b("#seo-holder",c.newPanel).length&&a.init_seo_tab(c.newPanel)},load:function(d,c){b(".posteditor-tag",c.panel).click(function(){a.addtag(b(this).text());return!1})}});b("#posteditor-init-raw-tabs").one("click",
function(){a.init_raw_tabs();return!1});b("#posteditor-init-files").one("click.initfiles",function(){litepubl.fileman=new litepubl.Fileman("#posteditor-files");return!1});b("form:first").submit(function(a){var c=b("input[name='title']");if(""==b.trim(c.val()))return a.stopImmediatePropagation(),b.messagebox(lang.dialog.error,lang.posteditor.emptytitle,function(){c.focus()}),!1})}},addtag:function(a){var d=b("#text-tags").val();if(""==d)b("#text-tags").val(a);else{for(var c=d.split(/\s*,\s*/),e=c.length;0<=
e;e--)if(a==c[e])return!1;b("#text-tags").val(d+", "+a)}},init_seo_tab:function(a){a=b("#seo-holder",a);a.replaceWith(a.get(0).firstChild.nodeValue)},init_datetime_tab:function(a){var d=b("#datetime-holder",a);a=b(d.get(0).firstChild.nodeValue).appendTo(a);d.remove();litepubl.calendar.on(a)},init_raw_tabs:function(){b("#posteditor-init-raw-tabs").remove();var a=b("#posteditor-raw-holder"),d=a.get(0).firstChild.nodeValue;b(a.get(0).firstChild).remove();var d=d.replace(/<comment>/gim,'<div class="tab-holder">\x3c!--').replace(/<\/comment>/gim,
"--\x3e</div>"),c=d.indexOf("<div");b("#posteditor-raw").before(d.substring(0,c)).after(d.substring(c));a.tabs({beforeLoad:litepubl.uibefore,beforeActivate:function(a,d){var c=b(".tab-holder",d.newPanel);c.length&&c.replaceWith(c.get(0).firstChild.nodeValue)}})},init_visual_link:function(a,d){b('<a href="#">'+d+"</a>").appendTo("#posteditor-visual").data("url",a).one("click",function(){b.load_script(b(this).data("url"));b("#posteditor-visual").remove();return!1})}});b(f).ready(function(){try{litepubl.posteditor=
new litepubl.Posteditor}catch(a){erralert(a)}})})(jQuery,document,window);
