(function(f,n,p){f.fn.popimage=function(d){d=f.extend({title:"",cursorclass:"cursor-loading",width:40,height:30},d);var a=!1,l=/\.(jpg|jpeg|png|bmp)$/;return this.each(function(){var h=f(this);a&&(h.data("prevlink",a),a.data("nextlink",h));a=h;h.one("mouseenter.popinit focus.popinit click.popinit",function(a){var c=f(this);c.off(".popinit");c.addClass(d.cursorclass);var k=c.attr("href");if(l.test(k))var m=" click";else{if("click"==a.type)return;m="";k=c.data("image")}c.data("focused",a.type).on(("mouseenter"==
a.type?"mouseleave":"blur")+".popinit",function(){f(this).data("focused",!1).off(".popinit")});var e=new Image;e.onload=function(){c.removeClass(d.cursorclass);if(100>d.width)var b=Math.floor(f(n).width()*d.width/100),a=Math.floor(b*d.height/d.width);else b=d.width,a=d.height;if(e.width<=b&&e.height<=a)b=e.width,a=e.height;else{var g=e.width/e.height;b/a>g?b=Math.floor(a*g):a=Math.floor(b/g)}g=c.attr("title");l.test(g)&&(g=d.title);c.popover({container:"body",content:'<img src="'+k+'" width="'+b+
'" height="'+a+'" />',html:!0,placement:"auto bottom",template:'<div class="popover popover-image"><div class="arrow"></div><h3 class="popover-title" style="max-width:'+b+'px;"></h3><div class="popover-content"></div></div>',title:g,trigger:"hover focus"+m});c.data("focused")&&c.trigger(c.data("focused"));if(b=c.data("nextlink"))(new Image).src=b.attr("href");if(b=h.data("prevlink"))(new Image).src=b.attr("href")};e.onerror=function(){alert("Error load image")};e.src=k;return!1})})};ready2(function(){f("a.photo").popimage()})})(jQuery,
window,document);
